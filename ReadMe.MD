
-----

# ğŸ“‚ Project: Web NAS (Private Cloud Storage)

ì´ ë¬¸ì„œëŠ” **OSì— ë…ë¦½ì **ìœ¼ë¡œ ë™ì‘í•˜ëŠ” ì›¹ ê¸°ë°˜ NAS ì‹œìŠ¤í…œì„ êµ¬ì¶•í•˜ê¸° ìœ„í•œ AI ì½”ë”© ì§€ì¹¨ì„œì…ë‹ˆë‹¤.

## 0\. ğŸ¤– Role Definition

  * **Role:** Senior Full-Stack Developer (Specialized in TypeScript)
  * **Goal:** Build a responsive, secure file management system using NestJS and Next.js.
  * **Target Environment:** Docker (Linux/Windows/macOS agnostic)

## 1\. ğŸ›  Tech Stack

| Category | Technology |
| :--- | :--- |
| **Backend** | NestJS, TypeScript, Node.js `fs` module, Multer |
| **Frontend** | Next.js 14+ (App Router), TypeScript, Axios |
| **UI/Design** | **MUI (Material UI)** v5, Emotion |
| **State/Query**| React Query (TanStack Query) or SWR (for file caching) |
| **Infrastructure** | Docker, Docker Compose |

## 2\. ğŸ“œ Global Rules & Coding Standards

1.  **OS Independence:** íŒŒì¼ ê²½ë¡œ ì²˜ë¦¬ ì‹œ ë°˜ë“œì‹œ Node.jsì˜ `path.join()`, `path.sep` ë“±ì„ ì‚¬ìš©í•˜ì—¬ ìœˆë„ìš°(\\)ì™€ ìœ ë‹‰ìŠ¤(/) ê²½ë¡œ ì°¨ì´ë¥¼ í•´ê²°í•œë‹¤.
2.  **Security First:** `Path Traversal` ê³µê²© ë°©ì§€ë¥¼ ìœ„í•´, ìš”ì²­ëœ ê²½ë¡œê°€ ë°˜ë“œì‹œ ì§€ì •ëœ `ROOT_DIR` ë‚´ë¶€ì— ìˆëŠ”ì§€ ê²€ì¦í•˜ëŠ” ë¡œì§ì„ í•„ìˆ˜ì ìœ¼ë¡œ í¬í•¨í•œë‹¤.
3.  **Responsive Design:** MUIì˜ `Grid`, `Box`, `useMediaQuery`ë¥¼ í™œìš©í•˜ì—¬ ëª¨ë°”ì¼(í–„ë²„ê±° ë©”ë‰´)ê³¼ ë°ìŠ¤í¬íƒ‘(ì‚¬ì´ë“œë°”) ë·°ë¥¼ ì™„ë²½íˆ ì§€ì›í•œë‹¤.
4.  **Type Safety:** í”„ë¡ íŠ¸ì—”ë“œì™€ ë°±ì—”ë“œ ê°„ì— ê³µìœ í•  ìˆ˜ ìˆëŠ” `FileDTO` ë“±ì˜ ì¸í„°í˜ì´ìŠ¤ë¥¼ ëª…í™•íˆ ì •ì˜í•œë‹¤.

-----

## 3\. ğŸ“… Phase-by-Phase Instruction Prompts

*(Copy and paste these prompts sequentially to the AI)*

### ğŸš€ Phase 1: Project Initialization & Layout

**Prompt:**

```markdown
[Phase 1 Task]
NestJS(Backend)ì™€ Next.js(Frontend) í”„ë¡œì íŠ¸ì˜ ê¸°ë³¸ êµ¬ì¡°ë¥¼ ì¡ì•„ì¤˜.

1. **Backend (NestJS):**
   - Port: 4000
   - Global Prefix: `/api`
   - CORS: `http://localhost:3000` í—ˆìš©
   - `.env`ë¥¼ í†µí•´ `ROOT_PATH`(íŒŒì¼ ì €ì¥ ë£¨íŠ¸)ë¥¼ ì„¤ì • ê°€ëŠ¥í•˜ê²Œ í•´ì¤˜.

2. **Frontend (Next.js + MUI):**
   - Next.js 14 App Router ê¸°ë°˜ìœ¼ë¡œ ì„¤ì •.
   - MUI `ThemeRegistry`ë¥¼ êµ¬ì„±í•˜ì—¬ SSR ìŠ¤íƒ€ì¼ ê¹¨ì§ ë°©ì§€.
   - **Layout:**
     - Left: Sidebar (Navigation). ë°ìŠ¤í¬íƒ‘ì—ì„  ê³ ì •, ëª¨ë°”ì¼ì—ì„  `Drawer`ë¡œ ë™ì‘.
     - Top: Header (AppBar).
     - Center: Main Content.
   - ëª¨ë°”ì¼ ë°˜ì‘í˜• ì²˜ë¦¬ë¥¼ ìœ„í•œ `useMediaQuery` í›… ì‚¬ìš© ì˜ˆì‹œ í¬í•¨.
```

### ğŸ“‚ Phase 2: Backend File System Core

**Prompt:**

```markdown
[Phase 2 Task]
NestJSì—ì„œ ë¡œì»¬ íŒŒì¼ ì‹œìŠ¤í…œì„ ì½ê³  ì“°ëŠ” `FileSystemService`ë¥¼ êµ¬í˜„í•´ì¤˜.

1. **API Endpoints:**
   - `GET /api/files?path=/`: í•´ë‹¹ ê²½ë¡œì˜ íŒŒì¼/í´ë” ëª©ë¡ ë°˜í™˜ (ì´ë¦„, íƒ€ì…, í¬ê¸°, ìˆ˜ì •ì¼).
   - `GET /api/files/download?path=/...`: íŒŒì¼ ë‹¤ìš´ë¡œë“œ (StreamableFile ì‚¬ìš©).

2. **Security & OS Agnostic:**
   - `path.resolve`ì™€ `path.normalize`ë¥¼ ì‚¬ìš©í•˜ì—¬ `Path Traversal` ê³µê²©ì„ ë§‰ëŠ” ê²€ì¦ ë¡œì§(`validatePath`)ì„ ë°˜ë“œì‹œ êµ¬í˜„í•´.
   - ìœˆë„ìš°ì™€ ë¦¬ëˆ…ìŠ¤ ì–´ë””ì„œë“  ê²½ë¡œê°€ ê¹¨ì§€ì§€ ì•Šê²Œ `path` ëª¨ë“ˆì„ ì² ì €íˆ ì‚¬ìš©í•´.
```

### ğŸ–¥ï¸ Phase 3: Frontend Explorer UI

**Prompt:**

```markdown
[Phase 3 Task]
Next.jsì™€ MUIë¥¼ ì‚¬ìš©í•˜ì—¬ íŒŒì¼ íƒìƒ‰ê¸° UIë¥¼ êµ¬í˜„í•´ì¤˜.

1. **Component Structure:**
   - `FileExplorer`: ë©”ì¸ ì»´í¬ë„ŒíŠ¸.
   - `FileGridItem`: íŒŒì¼/í´ë” ì•„ì´ì½˜ê³¼ ì´ë¦„ì„ ë³´ì—¬ì£¼ëŠ” ì¹´ë“œ í˜•íƒœ ì»´í¬ë„ŒíŠ¸.
   - `BreadcrumbsNav`: í˜„ì¬ ê²½ë¡œë¥¼ í‘œì‹œí•˜ê³  ìƒìœ„ë¡œ ì´ë™ ê°€ëŠ¥í•œ ë‚´ë¹„ê²Œì´ì…˜.

2. **Logic:**
   - `TanStack Query` (ë˜ëŠ” SWR)ë¥¼ ì‚¬ìš©í•˜ì—¬ ë°ì´í„°ë¥¼ í˜ì¹­í•˜ê³  ìºì‹±í•´.
   - í´ë” í´ë¦­ ì‹œ Query Param(`?path=...`)ì„ ì—…ë°ì´íŠ¸í•˜ì—¬ ë‚´ìš©ì„ ê°±ì‹ .
   - íŒŒì¼ í´ë¦­ ì‹œ ë‹¤ìš´ë¡œë“œ í˜¹ì€ ë¯¸ë¦¬ë³´ê¸° íŠ¸ë¦¬ê±°.
   - ë°ì´í„° ë¡œë”© ì¤‘ì—ëŠ” `Skeleton` UI í‘œì‹œ, ì—ëŸ¬ ì‹œ `Snackbar` í‘œì‹œ.
```

### ğŸ“¤ Phase 4: File Operations (Upload & Manage)

**Prompt:**

```markdown
[Phase 4 Task]
íŒŒì¼ ì—…ë¡œë“œ ë° ê´€ë¦¬ ê¸°ëŠ¥ì„ ì¶”ê°€í•´ì¤˜.

1. **Backend:**
   - `POST /api/files/upload`: `Multer`ë¥¼ ì‚¬ìš©í•˜ì—¬ íŒŒì¼ ì—…ë¡œë“œ. (ë™ì¼ ì´ë¦„ ì¡´ì¬ ì‹œ ìë™ ë¦¬ë„¤ì„ ì²˜ë¦¬).
   - `POST /api/files/mkdir`: ìƒˆ í´ë” ìƒì„±.
   - `DELETE /api/files`: íŒŒì¼/í´ë” ì‚­ì œ.

2. **Frontend:**
   - `React Dropzone`ì„ ì‚¬ìš©í•˜ì—¬ ë“œë˜ê·¸ ì•¤ ë“œë¡­ ì—…ë¡œë“œ êµ¬í˜„.
   - ì—…ë¡œë“œ ì§„í–‰ ìƒíƒœë¥¼ MUI `LinearProgress`ë¡œ í‘œì‹œ.
   - íŒŒì¼ ì•„ì´í…œì— ìš°í´ë¦­ í˜¹ì€ ë©”ë‰´ ë²„íŠ¼ì„ ë‹¬ì•„ì„œ 'ì‚­ì œ', 'ì´ë¦„ ë³€ê²½' ì˜µì…˜ ì œê³µ.
   - ì‚­ì œ ì‹œ `Dialog` ì»´í¬ë„ŒíŠ¸ë¡œ í™•ì¸ íŒì—… ë„ìš°ê¸°.
```

### ğŸ³ Phase 5: Docker Deployment

**Prompt:**

```markdown
[Phase 5 Task]
ì´ í”„ë¡œì íŠ¸ë¥¼ OS ìƒê´€ì—†ì´ ë°°í¬í•˜ê¸° ìœ„í•œ Docker ì„¤ì •ì„ ì‘ì„±í•´ì¤˜.

1. **Requirements:**
   - `Dockerfile`: Frontend(Next.js), Backend(NestJS) ê°ê° ì‘ì„± (Multi-stage buildë¡œ ìš©ëŸ‰ ìµœì í™”).
   - `docker-compose.yml`:
     - ë‘ ì»¨í…Œì´ë„ˆë¥¼ ë™ì‹œì— ì‹¤í–‰.
     - Hostì˜ `./nas-storage` í´ë”ë¥¼ ë°±ì—”ë“œ ì»¨í…Œì´ë„ˆì˜ `/app/data`ë¡œ ë³¼ë¥¨ ë§ˆìš´íŠ¸ (ë°ì´í„° ì˜ì†ì„± ë³´ì¥).
     - ë„¤íŠ¸ì›Œí¬ ì„¤ì •ìœ¼ë¡œ ì»¨í…Œì´ë„ˆ ê°„ í†µì‹  ì—°ê²°.
```

-----

## 4\. ğŸ“ Tips for AI Interaction

  * ì½”ë“œê°€ ê¸¸ì–´ì§€ë©´ \*\*"íŒŒì¼ë³„ë¡œ ë‚˜ëˆ„ì–´ì„œ ì½”ë“œë¥¼ ì‘ì„±í•´ì¤˜"\*\*ë¼ê³  ìš”ì²­í•˜ì„¸ìš”.
  * ì—ëŸ¬ê°€ ë°œìƒí•˜ë©´ ì—ëŸ¬ ë¡œê·¸ë¥¼ ê·¸ëŒ€ë¡œ ë³µì‚¬í•´ì„œ \*\*"ì´ ì—ëŸ¬ì˜ ì›ì¸ê³¼ í•´ê²° ì½”ë“œë¥¼ ì¤˜"\*\*ë¼ê³  í•˜ì„¸ìš”.
  * ë””ìì¸ì´ ë§ˆìŒì— ì•ˆ ë“¤ë©´ \*\*"MUI ìŠ¤íƒ€ì¼ì„ ì¢€ ë” ëª¨ë˜í•˜ê²Œ, ê·¸ë¦¼ì íš¨ê³¼ë¥¼ ì£¼ê³  ê°„ê²©ì„ ë„“í˜€ì¤˜"\*\*ë¼ê³  êµ¬ì²´ì ìœ¼ë¡œ ì§€ì‹œí•˜ì„¸ìš”.